---
## Front matter
title: "Лабораторная работа №5. Основы работы с
Midnight Commander (mc). Структура программы на
языке ассемблера NASM. Системные вызовы в ОС
GNU Linux"
subtitle: "Основы работы с Midnight Commander
Midnight Commander (или просто mc) — это программа, которая позволяет просматривать
структуру каталогов и выполнять основные операции по управлению файловой системой,
т.е. mc является файловым менеджером. Midnight Commander позволяет сделать работу с
файлами более удобной и наглядной."
author: "Виктор Ващаев Андреевич"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true # Table of contents
toc-depth: 2
lof: true # List of figures
lot: true # List of tables
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
	- spelling=modern
	- babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float} # keep figures where there are in the text
  - \floatplacement{figure}{H} # keep figures where there are in the text
---

# Цель работы
Цель работы:

    Изучение основ ассемблера:
        Получить практический опыт работы с языком ассемблера, понимания его синтаксиса и структуры программ.
        Освоить основы работы с регистрами, памятью и системными вызовами.

    Разработка программного кода:
        Научиться писать простые программы, выполняющие ввод, обработку и вывод данных.
        Понять, как организовывать код, используя функции и подпрограммы для упрощения и улучшения структуры программы.

    Работа с системными вызовами:
        Изучить, как использовать системные вызовы Linux для выполнения операций ввода-вывода (например, вывод текста на экран и ввод данных с клавиатуры).
        Понять, как взаимодействовать с операционной системой на низком уровне через прерывания и системные вызовы.

    Отладка и тестирование:
        Получить навыки отладки ассемблерного кода и тестирования его работоспособности.
        Научиться исправлять ошибки и оптимизировать код для достижения корректной работы программы.

    Применение внешних библиотек и модулей:
        Научиться подключать и использовать внешние файлы с подпрограммами, что позволяет структурировать код и повторно использовать его в различных проектах.

Итоговая задача:

В конечном итоге, цель данной работы заключается в создании программы, которая:

    Выводит приглашение к вводу данных.
    Считывает строку с клавиатуры.
    Выводит введённые данные на экран, тем самым демонстрируя навыки работы с ассемблером, системными вызовами и отладкой кода.
# Теоретическое введение
Основы работы с Midnight Commander
Midnight Commander (или просто mc) — это программа, которая позволяет просматривать
структуру каталогов и выполнять основные операции по управлению файловой системой,
т.е. mc является файловым менеджером. Midnight Commander позволяет сделать работу с
файлами более удобной и наглядной.

# Выполнение лабораторной работы
1. Собственно вот так выглядит наш любимый Midnight Commander (mc) 1.Откройте Midnight Commander
![Первый шаг](/home/victor/Pictures/Снимки экрана/1.png){#fig:001 width=70%}

2. С помощью клавиш ↑ и ↓ я навигировал по списку каталогов в терминале, чтобы найти каталог ~/work/arch-pc, который был создан в ходе выполнения лабораторной работы №4. После того как я выделил нужный каталог, я нажал Enter, что позволило мне успешно перейти в этот каталог и продолжить выполнение следующих шагов задания.
![Второй шаг](/home/victor/Pictures/Снимки экрана/2.png){#fig:001 width=70%}

3. Создавал в mcedit, сфоткал в nano. Я использовал функциональную клавишу F7 для создания новой папки с именем lab05. После успешного создания папки я перешел в этот каталог, что позволило мне организовать свои файлы и продолжить работу в удобном для меня пространстве. Теперь все необходимые материалы находятся в новой папке lab05.


4. 
В ходе выполнения задания я воспользовался строкой ввода и командой touch, чтобы создать файл с именем lab5-1.asm. Я ввел команду в терминале, и после её выполнения новый файл был успешно создан в текущем каталоге. Теперь я могу продолжить работу с этим файлом в дальнейшем.


5. Задача была выполнена с помощью функциональной клавиши F4, которая открыла файл lab5-1.asm для редактирования. Я использовал встроенный редактор, который в данном случае оказался nano, так как именно он обычно используется в Midnight Commander. В процессе редактирования я смог внести необходимые изменения в файл, что позволило мне продолжить выполнение дальнейших шагов задания.


6. Я ввел текст программы из листинга 5.1 в файл, не включая комментарии. После того как все строки были аккуратно вставлены, я сохранил изменения, используя команды редактора, и закрыл файл. Это позволило мне сохранить выполненную работу и подготовить файл к дальнейшим действиям. Еще у меня были ошибки с 32 и 64 битами, все было исправлено
/home/victor/Pictures/Снимки экрана/6. сменил на 32 битную!.png
![6 шаг](/home/victor/Pictures/Снимки экрана/6. сменил на 32 битную!.png){#fig:001 width=70%}

7. Я использовал функциональную клавишу F3, чтобы открыть файл lab5-1.asm для просмотра. После этого я внимательно проверил содержимое файла и убедился, что в нем действительно присутствует текст программы. Это подтверждение дало мне уверенность в том, что все изменения были выполнены корректно.

8. Я оттранслировал текст программы из файла lab5-1.asm в объектный файл, выполнив соответствующую команду в терминале. Затем я скомпоновал объектный файл, чтобы получить исполняемый файл. После успешной компоновки я запустил исполняемый файл, и программа вывела строку "Введите строку:", ожидая ввода с клавиатуры. На этот запрос я ввел свои ФИО, что позволило программе продолжить выполнение с предоставленной информацией.

9. Я скачал файл in_out.asm со страницы курса в ТУИС и убедился, что он находится в том же каталоге, что и файл lab5-1.asm. Для этого я открыл каталог с файлом lab5-1.asm в одной из панелей Midnight Commander, а в другой панели открыл каталог со скачанным файлом in_out.asm, используя клавишу Tab для переключения между панелями.


Затем я скопировал файл in_out.asm в каталог с файлом lab5-1.asm, воспользовавшись функциональной клавишей F5. После успешного копирования я выделил файл lab5-1.asm и нажал клавишу F6, чтобы создать его копию с именем lab5-2.asm. Я ввел новое имя файла lab5-2.asm и подтвердил создание, нажав клавишу Enter.

Затем я открыл файл lab5-2.asm и исправил текст программы, добавив подпрограммы из внешнего файла in_out.asm, такие как sprintLF, sread и quit, в соответствии с листингом 5.2. После внесения изменений я создал исполняемый файл и проверил его работу, убедившись, что программа функционирует корректно.
3,4,5,7,8,9,10,11,12,13
![След шаг](/home/victor/Pictures/Снимки экрана/3, делал в mcedit, сфоткал nano.png){#fig:001 width=70%}
![След шаг](/home/victor/Pictures/Снимки экрана/4.png){#fig:001 width=70%}
![След шаг](/home/victor/Pictures/Снимки экрана/5.png){#fig:001 width=70%}

13. Я заметил интересную вещь:
    sprintLF:
        Эта подпрограмма выводит строку с переходом на новую строку после текста. Другими словами, после вывода строки курсор перемещается на новую строку.
        Это полезно, когда вы хотите разделить вывод, чтобы новый текст начинался с новой строки.

    sprint:
        Эта подпрограмма выводит строку без перехода на новую строку. После вывода строки курсор остается в конце этой строки.
        Если после этого не добавить переход на новую строку вручную, следующий вывод появится на той же строке.
![13 шаг](/home/victor/Pictures/Снимки экрана/7. поменял на sprint и заметил.png){#fig:001 width=70%}
1. Самостоятельная работа!
Создание копии файла и внесение изменений в программу

В первую очередь, я создал копию файла lab5-1.asm, чтобы внести в него изменения, не затрагивая оригинал. Для этого я использовал функциональные клавиши в Midnight Commander. После создания копии я открыл файл lab5-2.asm для редактирования. Внесенные изменения позволили программе работать по следующему алгоритму:

    Сначала программа выводит приглашение "Введите строку:".
    Затем я добавил возможность ввода строки с клавиатуры.
    Наконец, программа выводит введённую строку на экран.

Все изменения я сохранил и закрыл файл, чтобы подготовить его к следующему этапу.
![Мой код](/home/victor/Pictures/Снимки экрана/мой код.png){#fig:001 width=70%}

2. 
Получение исполняемого файла и проверка его работы

После внесения изменений я преобразовал файл lab5-2.asm в исполняемый файл. Я выполнил необходимые команды для трансляции и компоновки, и, наконец, запустил получившийся исполняемый файл. Программа успешно вывела приглашение "Введите строку:", и я ввёл свою фамилию, после чего она корректно отобразила введённые данные на экране.
3. Создание копии файла lab5-2.asm и исправление программы

Затем я снова создал копию файла lab5-2.asm, назвав её lab5-3.asm. Это позволило мне внести изменения, используя подпрограммы из внешнего файла in_out.asm. Я убедился, что файл in_out.asm находится в том же каталоге, что и lab5-3.asm, так как это было важно для корректной работы программы. Открыв lab5-3.asm, я исправил текст программы, добавив следующие функции:

    Вывод приглашения "Введите строку:".
    Ввод строки с клавиатуры.
    Вывод введённой строки на экран.
 ![Копия](/home/victor/Pictures/Снимки экрана/8.png){#fig:001 width=70%}
4. Создание исполняемого файла и проверка его работы

После внесения всех изменений я снова создал исполняемый файл из lab5-3.asm, следуя тем же шагам трансляции и компоновки. Когда я запустил исполняемый файл, программа вновь вывела приглашение "Введите строку:". Я ввёл свою фамилию и убедился, что программа правильно обработала введенные данные и отобразила их на экране.

    



# Выводы
Итог

Эта лабораторная работа позволила нам научиться:

    Работать с ассемблером и структурой программы.
    Использовать подпрограммы для организации кода.
    Понимать, как работает ввод и вывод данных на низком уровне.
    Исправлять ошибки и отлаживать код.

# Список литературы{.unnumbered}

::: {#refs}
:::
